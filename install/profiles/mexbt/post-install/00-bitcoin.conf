#!/bin/sh

if [ -n "$UPGRADE" ]; then
    exit 0
fi

# generate bitcoin password
cd $profile_conf
BITCOIND_PASSWORD=`openssl rand -base64 32 | tr +/ -_`
sed -i "s/\(rpcpassword=\).*/\1$BITCOIND_PASSWORD/" bitcoin.conf


# replace testnet=true with testnet=1
sed -i 's/^testnet=true$/testnet=1/' bitcoin.conf
sed -i 's/^testnet=yes$/testnet=1/' bitcoin.conf

# replace testnet=false with testnet=0
sed -i 's/^testnet=false$/testnet=0/' bitcoin.conf
sed -i 's/^testnet=no$/testnet=0/' bitcoin.conf